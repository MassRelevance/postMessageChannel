<!doctype html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>This is the parent</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="../src/postMessageChannel.js" type="text/javascript"></script>
  </head>
  <body>
  	<iframe id="childFrame" src="child.html"></iframe>
  	<button id="sendButton">Send</button>
  	<script type="text/javascript">
  		(function () {
  			var pmc = postMessageChannel({
  				window: document.getElementById('childFrame').contentWindow,
  				origin: window.location.origin,
  				scope: 'myScope',
  				methods: {

  				}
  			});

  			$('#sendButton').click(function () {
	  			pmc.ready(function () {
	  				var req = pmc.run('hello', { subject: 'world' + Math.random() });
		  			req.then(function (data) {
		  				console.log('Got back', data);
		  			});
	  			});
  				return false;
  			});

  		}());
  	</script>
  </body>
</html>
